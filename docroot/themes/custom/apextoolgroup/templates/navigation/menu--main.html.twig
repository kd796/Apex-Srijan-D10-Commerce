{% import _self as menus %}

{#
  We call a macro which calls itself to render the full tree.
  @see http://twig.sensiolabs.org/doc/tags/macro.html
#}
{{ menus.menu_links(items, attributes, 0) }}

{% macro menu_links(items, attributes, menu_level) %}
  {% import _self as menus %}
    {% if menu_level == 0 %}
      <ul class="navbar-nav">
          {% if items %}
            {% for item in items %}
              {% if item.below %}
                {%
                    set classes = [
                      'nav-link angle-down drop-toggle pt-nav-link' ,
                      item.in_active_trail ? 'active',
                    ]
                  %}
                <li class="nav-item dropdown">
                  <a {{ item.attributes.addClass(classes)}} href="{{ item.url }}" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                   {{ item.title }}
                  </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                    {{ menus.menu_links(item.below, attributes, menu_level + 1) }}
                  </ul>
                </li>
              {% else %}
                {%
                    set classes = [
                      'nav-link pt-nav-link' ,
                      item.in_active_trail ? 'active',
                    ]
                  %}
                <li class="nav-item">
                  <a {{ item.attributes.addClass(classes)}} href="{{ item.url }}">{{ item.title }}</a>
                </li>
              {% endif %}
            {% endfor %}
          {% endif %}
        </ul>
    {% elseif menu_level == 1 %}
      {% if items %}
          {% for item in items %}
            {% if item.below %}
              <li class="dropdown-second">
              <a class="dropdown-item angle-right drop-toggle" href="{{ item.url }}">{{ item.title }}</a>
                    <ul class="dropdown-menu">
                      {{ menus.menu_links(item.below, attributes, menu_level + 1) }}
                    </ul>
              </li>
            {% else %}
            <li><a class="dropdown-item" href="{{ item.url }}">{{ item.title }}</a></li>
            {% endif %}
          {% endfor %}
      {% endif %}
    {% elseif menu_level == 2 %}
        {% if items %}
          {% for item in items %}
            {% if item.below %}
              <li class="dropdown-third">
              <a class="dropdown-item angle-right drop-toggle" href="{{ item.url }}">{{ item.title }}</a>
                    <ul class="dropdown-menu">
                      {{ menus.menu_links(item.below, attributes, menu_level + 1) }}
                    </ul>
              </li>
            {% else %}
            <li><a class="dropdown-item" href="{{ item.url }}">{{ item.title }}</a></li>
            {% endif %}
          {% endfor %}
        {% endif %}
    {% elseif menu_level == 3 %}
        {% if items %}
          {% for item in items %}
            <li><a class="dropdown-item" href="{{ item.url }}">{{ item.title }}</a></li>
          {% endfor %}
        {% endif %}
    {% endif %}
{% endmacro %}


